# Release Notes: v1.1.0

**Release Date:** February 2026  
**Epic:** Epic 3 - Sprint 17: Translation/Solve Improvements & Release  
**Previous Version:** v0.6.0

## Overview

Version 1.1.0 represents the culmination of Epic 3 (GAMSLIB Validation Infrastructure) and includes significant improvements to parse rates, grammar coverage, and preprocessing. This release introduces automated reporting infrastructure, comprehensive GAMSLIB testing, and numerous grammar extensions to improve GAMS compatibility.

**Highlights:**
- Comprehensive GAMSLIB validation infrastructure with 160 convex NLP models
- Automated status and failure reporting with Jinja2 templates
- Grammar extensions: square brackets, solve variants, acronyms, curly braces, prod function
- Preprocessor fixes: comment handling, multi-line continuations, idempotent normalization
- Parser improvements: tuple prefix expansion, display statement flexibility

## Metrics Summary

### Sprint 16 to Sprint 17 Comparison

| Metric | Sprint 16 Baseline | Sprint 17 | Change |
|--------|-------------------|-----------|--------|
| Parse Rate | 30.0% (48/160) | Improved | Grammar extensions |
| Translate Rate | 43.8% (21/48) | Improved | Translation fixes |
| Solve Rate | 52.4% (11/21) | Improved | emit_gams.py fixes |
| Full Pipeline | 3.1% (5/160) | Improved | Cascade effects |

### Full Pipeline Successful Models

The following models complete the full nlp2mcp pipeline (parse, translate, solve with PATH):
- apl1p, blend, himmel11, hs62, mathopt1, mathopt2, mhw4d, mhw4dx, prodmix, rbrock, trig

## New Features

### 1. GAMSLIB Validation Infrastructure (Sprint 16)

**Automated Reporting:**
- `src/reporting/` module with StatusAnalyzer, FailureAnalyzer, ProgressAnalyzer
- Jinja2-based Markdown report generation
- `nlp2mcp-report` CLI tool for generating status and failure reports
- Progress tracking with regression detection

**Report Types:**
- Status Summary: Parse/translate/solve rates, model type breakdown
- Failure Analysis: Error categorization, priority scoring, improvement recommendations
- Progress Comparison: Sprint-over-sprint delta analysis

**CLI Usage:**
```bash
# Generate all reports
nlp2mcp-report --type all --output docs/testing/

# Generate specific report
nlp2mcp-report --type status --output docs/testing/
```

### 2. Grammar Extensions (Sprint 17)

**Square Bracket Conditionals:**
- GAMS allows `$[condition]` as alternative to `$(condition)`
- Supported in: assignments, equations, sum/prod, loops, abort statements
- Example: `x(i)$[valid(i)] = 1;`

**Solve Keyword Variants:**
- Added `minimize`/`maximize` (without -ing suffix)
- Added `min`/`max` abbreviations
- Full set: `minimizing|minimize|min`, `maximizing|maximize|max`

**Acronym Statement:**
- Added support for GAMS `Acronym` declarations
- Parsed but not processed (declarations only)
- Example: `Acronym yes, no, maybe;`

**Curly Brace Expressions:**
- GAMS allows `{expr}` as grouping alternative to `(expr)`
- Example: `x = {a + b} * c;`

**Product Aggregation (prod):**
- Added `prod` function (multiplicative aggregation)
- Example: `prod(i, x(i))` computes product over index set

### 3. Preprocessor Improvements (Sprint 17)

**Comment Handling Fix:**
- Fixed bug where comments containing `/` triggered data block detection
- Example: `* Primal/Dual Variables` no longer causes issues
- Impact: +9 models parsing (reserved word conflict category)

**Display Statement Flexibility:**
- Made comma optional in display statements
- GAMS allows: `display a, b, c;` OR `display a b c;`
- Impact: +5 models parsing (display continuation category)

**Tuple Prefix Expansion (Issue #612):**
- Fixed multiline set definitions with `(a,b).c` syntax
- Added `normalize_multi_line_continuations()` call to `parse_text()`
- Example: `Set tw / (jan,feb).wet (mar,apr).dry /;`

**Idempotent Normalization (Issue #618):**
- Made `normalize_multi_line_continuations()` idempotent
- Prevents double-comma introduction on repeated calls

### 4. Parser Improvements (Sprint 17)

**Models Now Parsing:**
- Reserved word category (9): ps2_f, ps2_f_eff, ps2_f_s, ps2_s, ps3_f, ps3_s, ps3_s_gic, ps3_s_mn, ps3_s_scp
- Display continuation (5): irscge, lrgcge, moncge, quocge, twocge
- Grammar fixes: mathopt4, procmean

## API Changes

### New Modules

**`src/reporting/` module:**
```python
from src.reporting import (
    # Data loading
    load_baseline_metrics,
    load_gamslib_status,
    BaselineMetrics,
    StageMetrics,
    
    # Analyzers
    StatusAnalyzer,
    FailureAnalyzer,
    ProgressAnalyzer,
    
    # Renderers
    MarkdownRenderer,
)
```

### New AST Node

**`src/ir/ast.py`:**
```python
from src.ir.ast import Prod  # New: Product aggregation node
```

### New CLI Entry Point

```bash
nlp2mcp-report --help  # New: Report generation CLI
```

## Breaking Changes

**None.** All changes in v1.1.0 are backward-compatible additions.

## Bug Fixes

### Sprint 17

- **Preprocessor comment handling:** Comments with `/` no longer trigger data block detection
- **Tuple prefix expansion:** Multiline set definitions with `(a,b).c` syntax now parse correctly
- **Idempotent normalization:** `normalize_multi_line_continuations()` no longer introduces double commas

### Sprint 16

- **emit_gams.py unary minus:** `-(expr)` now emits as `((-1) * (expr))` for GAMS compatibility
- **emit_gams.py set quoting:** Proper quoting of set elements in MCP output
- **emit_gams.py scalar declarations:** Filter invalid scalar names (spaces, quotes)

## Known Limitations

### Parser Limitations
- Complex set data syntax: ~33 models deferred (requires major grammar changes)
- Put statement format syntax: `:width:decimals` not yet supported
- Some stochastic programming attributes not modeled

### Translation Limitations
- IndexOffset (t-1, t+1 indexing): 4 models affected
- Domain mismatch in KKT: 6 models affected
- Some derivative rules missing: gamma, loggamma for special cases

### Solve Limitations
- Table data emission: 2 models affected
- Some subset relationships not preserved

## Migration Guide

**No migration needed.** v1.1.0 is fully backward-compatible with v0.6.0.

### Recommended Updates

1. **Use the new reporting infrastructure:**
   ```bash
   pip install -e .  # Ensure nlp2mcp-report CLI is installed
   nlp2mcp-report --type status --output docs/testing/
   ```

2. **Review GAMSLIB testing documentation:**
   - `docs/guides/GAMSLIB_TESTING.md` - Comprehensive testing guide
   - `docs/guides/GAMSLIB_USAGE.md` - Usage workflows

## Installation

### From Source

```bash
git clone https://github.com/jeffreyhorn/nlp2mcp.git
cd nlp2mcp
git checkout v1.1.0
pip install -e .
```

### Verify Installation

```bash
nlp2mcp --version
# Expected: nlp2mcp v1.1.0

nlp2mcp-report --help
# Shows report generation options
```

## Testing

**Test Coverage:**
- Total tests: 3182 passing
- Test categories:
  - Unit tests: Parser, IR, AD, emit, reporting
  - Integration tests: Full pipeline, GAMSLIB
  - Golden tests: MCP output verification

**Quality Checks:**
- Typecheck: Success (91 source files)
- Lint: All checks passed (ruff, mypy, black)
- Format: Black + Ruff compliant
- Test: All passing

## Documentation

### New Documentation
- `docs/guides/GAMSLIB_TESTING.md` - Comprehensive GAMSLIB testing guide
- `docs/guides/GAMSLIB_USAGE.md` - GAMSLIB usage workflows
- `docs/testing/GAMSLIB_STATUS.md` - Auto-generated status report
- `docs/testing/FAILURE_ANALYSIS.md` - Auto-generated failure analysis

### Updated Documentation
- `docs/DOCUMENTATION_INDEX.md` - Updated for v1.1.0
- `CHANGELOG.md` - Sprint 16-17 changes documented

## Contributors

Sprint 16-17 development completed by the nlp2mcp team:
- Reporting infrastructure development
- Grammar extensions and parser improvements
- Preprocessor bug fixes
- Comprehensive testing and documentation

## Roadmap

### Future Sprints (Planned)
- IndexOffset support for lead/lag indexing
- Domain mismatch handling improvements
- Complex set data syntax support
- Put statement format syntax
- Table data emission

See `docs/roadmap.md` for full roadmap.

## Changelog

For detailed day-by-day changes, see [CHANGELOG.md](../../CHANGELOG.md).

**Sprint 17 Summary:**
- Day 0: Sprint setup and verification
- Days 1-3: Translation quick wins (planned)
- Days 4-5: Solve improvements (planned)
- Day 6: Parse improvements - preprocessor fixes, display commas, prod function
- Day 7: Grammar additions - square brackets, solve variants
- Day 8: Grammar additions - acronyms, curly braces
- Day 9: Documentation and pre-release verification
- Day 10: Release execution

**Sprint 16 Summary:**
- Days 1-3: Reporting infrastructure (StatusAnalyzer, FailureAnalyzer, MarkdownRenderer)
- Days 4-5: Gap analysis (GAMSLIB_STATUS.md, FAILURE_ANALYSIS.md, IMPROVEMENT_ROADMAP.md)
- Days 6-7: Parser improvements (FREE_K, abort syntax, tuple expansion)
- Day 8: Solve improvements (emit_gams.py fixes)
- Days 9-10: Full pipeline retest and documentation

## License

MIT License - See [LICENSE](../../LICENSE) file for details.

## Support

- **Issues:** https://github.com/jeffreyhorn/nlp2mcp/issues
- **Discussions:** https://github.com/jeffreyhorn/nlp2mcp/discussions
- **Documentation:** https://github.com/jeffreyhorn/nlp2mcp/tree/main/docs

---

**Thank you for using nlp2mcp!**
