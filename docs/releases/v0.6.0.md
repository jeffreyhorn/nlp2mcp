# Release Notes: v0.6.0

**Release Date:** TBD (Sprint 6 completion)  
**Epic:** Epic 2 - Sprint 6: Convexity Heuristics, Bug Fixes, GAMSLib, UX

## Overview

Version 0.6.0 introduces major UX improvements focused on helping users understand model properties, track conversion progress, and debug issues. This release includes convexity detection heuristics, GAMSLib benchmark integration, structured error messages, and comprehensive documentation.

**Highlights:**
- üîç Convexity pattern detection with 5 heuristic rules
- üìä GAMSLib integration with conversion dashboard
- üìù Structured error messages with documentation links
- üöÄ Nested min/max flattening optimization
- üìö Comprehensive user documentation

## New Features

### 1. Convexity Heuristics (Days 1-4)

**Nested Min/Max Flattening:**
- Automatically flattens nested `min(min(...))` and `max(max(...))` expressions
- Reduces auxiliary variables in MCP reformulation
- Example: `min(min(x,y),z)` ‚Üí `min(x,y,z)`
- Performance: 16.7% fewer variables, 25% fewer equations

**Convexity Pattern Detection:**
- Detects 5 common nonconvex patterns:
  - W301: Nonlinear equality constraints
  - W302: Trigonometric functions (sin, cos, tan)
  - W303: Bilinear terms (variable √ó variable)
  - W304: Variable quotients (division by variable)
  - W305: Odd-power polynomials (x¬≥, x‚Åµ, x‚Å∑, ...)

**CLI Integration:**
```bash
# Show convexity warnings
nlp2mcp model.gms -o output.gms

# Suppress warnings
nlp2mcp model.gms -o output.gms --skip-convexity-check
```

**Warning Format:**
```
‚ö†Ô∏è  Convexity Warnings:

  W301: Nonlinear equality constraint detected (may be non-convex)
     Equation: circle_eq
     Details: Nonlinear equality h(x) = 0
     Docs: https://github.com/jeffreyhorn/nlp2mcp/blob/main/docs/errors/README.md#w301-nonlinear-equality
```

**Documentation:**
- Comprehensive guide: `docs/errors/convexity_warnings.md`
- Mathematical explanations for each pattern
- Examples and reformulation techniques
- Solver recommendations

### 2. GAMSLib Integration (Days 5-6)

**Model Ingestion:**
- Automated ingestion of GAMSLib benchmark models
- Parse-only validation (MCP conversion in future sprints)
- Error categorization and analysis

**Conversion Dashboard:**
- Live Markdown dashboard at `docs/status/GAMSLIB_CONVERSION_STATUS.md`
- KPI metrics: Parse%, Convert%, Solve%, E2E success
- Per-model status tracking
- Error breakdown by category

**Makefile Integration:**
```bash
# Run ingestion and generate dashboard
make ingest-gamslib
```

**Baseline Metrics (Sprint 6):**
- Total models: 10 (Tier 1)
- Parse rate: 10% (1/10 models)
- Target for Sprint 7: ‚â•30% parse rate

### 3. Error Message Integration (Day 7)

**Error Code Registry:**
- Centralized error code system in `src/utils/error_codes.py`
- 9 error codes registered (E001-E003, E101, W301-W305)
- Automatic documentation URL generation

**Error Code Scheme:**
- Format: `{Level}{Category}{Number}`
- Levels: E (Error), W (Warning), I (Info)
- Categories:
  - 0xx: Syntax/Validation
  - 1xx: Parser
  - 3xx: Convexity
  - 2xx, 9xx: Reserved for future

**Comprehensive Documentation:**
- User-facing error catalog: `docs/errors/README.md`
- Each error includes:
  - Description and common causes
  - How to fix (quick fix + detailed steps)
  - GAMS code examples (before/after)
  - Example error messages
  - Related errors

**Registered Error Codes:**

*Validation Errors (E0xx):*
- **E001**: Undefined variable
- **E002**: Undefined equation
- **E003**: Type mismatch

*Parser Errors (E1xx):*
- **E101**: Syntax error

*Convexity Warnings (W3xx):*
- **W301**: Nonlinear equality (nonconvex)
- **W302**: Trigonometric function (nonconvex)
- **W303**: Bilinear term (nonconvex)
- **W304**: Division by variable (nonconvex)
- **W305**: Odd-power polynomial (nonconvex)

### 4. Documentation & Polish (Day 8)

**New Documentation:**
- `docs/getting_started.md` - Comprehensive tutorial
- `docs/roadmap.md` - Future features roadmap
- `docs/planning/EPIC_2/SPRINT_6/SPRINT_6_DEMO.md` - Demo checklist
- `docs/releases/v0.6.0.md` - This document

**Updated Documentation:**
- README.md: Sprint 6 progress marked complete
- Error documentation with examples and fixes
- CLI help text improvements

**Unknowns Resolved:**
- Unknown 4.3: Convexity warning suppression ‚Üí Deferred to Sprint 7+
- Unknown 4.4: Demo checklist tracking ‚Üí Markdown checklist in SPRINT_6_DEMO.md

## API Changes

### New Exports

**`src/utils` module:**
```python
from src.utils import (
    # Error codes
    ERROR_REGISTRY,
    ErrorInfo,
    get_error_info,
    get_all_error_codes,  # New in v0.6.0
    # Error formatting
    ErrorContext,
    FormattedError,
    create_parse_error,
    create_warning,
    get_source_lines,
)
```

### New CLI Flags

```bash
--skip-convexity-check    # Suppress convexity warnings (new)
```

## Breaking Changes

**None.** All changes in v0.6.0 are backward-compatible additions.

## Performance Improvements

- **Nested min/max flattening**: 16.7% fewer variables, 25% fewer equations
- **Expression simplification**: Continued optimization (advanced mode default)
- **Convexity detection**: <100ms overhead on typical models

## Bug Fixes

**Sprint 6 focused on features; no critical bugs fixed in this release.**

Previous bug fixes from earlier sprints:
- Fixed indexed equation handling (v0.3.1, Issue #47)
- Fixed parser line/column tracking
- Fixed circular include detection

## Known Limitations

### Parser Limitations
- GAMSLib parse rate: 10% (Sprint 6 baseline)
- Limited support for:
  - Variable attribute syntax (`.l`, `.lo`, `.up` assignments)
  - Model equation list syntax (`Model mx /eq1, eq2/`)
  - Compiler directives (`$if`, `$set`)
  - Set range syntax (`Set i /1*6/`)

**Planned improvements in Sprint 7:**
- Variable attribute syntax support (Priority 1)
- Model equation list support (Priority 2)
- Target: ‚â•30% GAMSLib parse rate

### Convexity Detection Limitations
- Heuristics may produce **false positives** (flag convex models as nonconvex)
- Conservative approach: Never false negatives
- Not a formal convexity proof
- See `docs/errors/convexity_warnings.md` for details

### Feature Limitations
- Fine-grained convexity warning suppression: Not available (use `--skip-convexity-check` for all)
- MCP solving: nlp2mcp generates MCP formulation but doesn't solve it
- Control flow: Not supported (`Loop`, `If`, `While`)

## Migration Guide

**No migration needed.** v0.6.0 is fully backward-compatible with v0.5.x.

### Recommended Updates

1. **Review convexity warnings** on existing models:
   ```bash
   nlp2mcp your_model.gms -o output.gms
   ```
   If you see W3xx warnings, consult `docs/errors/README.md` for guidance.

2. **Update scripts** to suppress warnings if desired:
   ```bash
   nlp2mcp your_model.gms -o output.gms --skip-convexity-check
   ```

3. **Explore error documentation** for better debugging:
   - Browse `docs/errors/README.md` for error code reference
   - Use error code links in messages for quick fixes

## Installation

### From PyPI

```bash
pip install --upgrade nlp2mcp
```

Verify version:

```bash
nlp2mcp --version
# Expected: nlp2mcp v0.6.0
```

### From Source

```bash
git clone https://github.com/jeffreyhorn/nlp2mcp.git
cd nlp2mcp
git checkout v0.6.0
pip install -e .
```

## Testing

**Test Coverage:**
- Total tests: 1214 passing, 2 skipped, 1 xfailed
- New tests in v0.6.0:
  - Convexity pattern detection: 18 unit tests, 14 integration tests
  - Error code registry: 17 unit tests
  - Min/max flattening: 36 unit tests
- Zero regressions

**Quality Checks:**
- Typecheck: ‚úÖ Success (58 source files)
- Lint: ‚úÖ All checks passed
- Format: ‚úÖ Black + Ruff compliant
- Test: ‚úÖ 1214/1217 passing

## Documentation

### New Documentation
- [Getting Started Guide](../getting_started.md)
- [Error Code Reference](../errors/README.md)
- [Convexity Warnings Guide](../errors/convexity_warnings.md)
- [Roadmap](../roadmap.md)
- [Sprint 6 Demo Checklist](../planning/EPIC_2/SPRINT_6/SPRINT_6_DEMO.md)

### Updated Documentation
- [README.md](../../README.md) - Sprint 6 progress complete
- [CHANGELOG.md](../../CHANGELOG.md) - Detailed day-by-day summaries

## Contributors

Sprint 6 was completed by the nlp2mcp development team with support from:
- Convexity Team (Days 1-4)
- GAMSLib Team (Days 5-6)
- UX Team (Days 7-8)
- QA Team (Days 9-10)

## Roadmap

### Sprint 7 (Planned)
- Parser improvements: Variable attributes, model equation lists
- GAMSLib parse rate: Target ‚â•30%
- Fine-grained convexity warning suppression
- Semi-automated ingestion with `make ingest-gamslib`

### Sprint 8+ (Future)
- MCP conversion tracking in dashboard
- PATH solver integration
- CI/CD automation for GAMSLib ingestion
- Additional GAMS directive support

See [docs/roadmap.md](../roadmap.md) for full roadmap.

## Changelog

For detailed day-by-day changes, see [CHANGELOG.md](../../CHANGELOG.md).

**Sprint 6 Summary:**
- Day 0: Pre-sprint research (5 unknowns resolved)
- Day 1: Nested min/max research (4 unknowns resolved)
- Day 2: Nested min/max implementation (36 tests)
- Day 3: Convexity heuristics - core patterns (5 patterns, 18 tests)
- Day 4: Convexity heuristics - CLI integration (14 E2E tests)
- Day 5: GAMSLib integration - model ingestion (10 models)
- Day 6: GAMSLib integration - conversion dashboard
- Day 7: UX improvements - error message integration (9 error codes)
- Day 8: UX improvements - documentation & polish
- Day 9: Testing & quality assurance (planned)
- Day 10: Release preparation & sprint review (planned)

## License

MIT License - See [LICENSE](../../LICENSE) file for details.

## Support

- **Issues:** https://github.com/jeffreyhorn/nlp2mcp/issues
- **Discussions:** https://github.com/jeffreyhorn/nlp2mcp/discussions
- **Documentation:** https://github.com/jeffreyhorn/nlp2mcp/tree/main/docs

---

**Thank you for using nlp2mcp!**
